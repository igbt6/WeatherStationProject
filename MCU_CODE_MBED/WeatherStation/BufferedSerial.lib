http://mbed.org/users/sam_grove/code/BufferedSerial/#8287e83943f0
